# BERTopic å®Œæ•´åŠŸèƒ½æ¸…å•

**é¡¹ç›®**: è·¨å¢ƒç”µå•†ç¨æ”¶æ”¿ç­–èˆ†è®ºå¯è§†åŒ–ç³»ç»Ÿ  
**æœ€åæ›´æ–°**: 2025-12-11  
**æ•°æ®è§„æ¨¡**: 2,297æ¡åˆ†ææ„è§

---

## ğŸ“Š åŠŸèƒ½çŸ©é˜µ

### âœ… å·²å®ç°åŠŸèƒ½ (Phase 3 - å·²æ¨é€)

| åŠŸèƒ½ID | åŠŸèƒ½åç§° | æ‰€åœ¨ä½ç½® | å®ç°çŠ¶æ€ | ä»·å€¼ |
|--------|--------|--------|--------|------|
| F001 | visualize_topics_2d | é¡µé¢7 Tab1 | âœ… å®Œæˆ | â­â­â­â­â­ |
| F002 | visualize_documents_2d | é¡µé¢7 Tab2 | âœ… å®Œæˆ | â­â­â­â­â­ |
| F003 | visualize_topic_similarity | é¡µé¢7 Tab3 | âœ… å®Œæˆ | â­â­â­â­ |
| F004 | visualize_topic_hierarchy | é¡µé¢7 Tab4 | âœ… å®Œæˆ | â­â­â­â­ |
| F005 | visualize_term_distribution | é¡µé¢7 Tab7 | âœ… å®Œæˆ | â­â­â­â­ |
| F006 | visualize_term_score_decline | é¡µé¢8 Section1 | âœ… å®Œæˆ | â­â­â­â­ |
| F007 | get_topic_keywords_detailed | é¡µé¢8 Section2 | âœ… å®Œæˆ | â­â­â­â­ |
| F008 | visualize_topic_per_class | é¡µé¢8 Section3-4 | âœ… å®Œæˆ | â­â­â­â­ |

**å·²å®ç°æ€»æ•°**: 8 ä¸ªåŠŸèƒ½  
**ä»£ç è¡Œæ•°**: ~430 è¡Œ  
**Commits**: 2ä¸ª (03486d9, 71809ab)

---

## ğŸš€ é«˜ä¼˜å…ˆçº§å¾…å®ç°åŠŸèƒ½

### ç¬¬ä¸€æ¢¯é˜Ÿ (å¿…åš) - å¯è§£é‡Šæ€§å’Œæ•°æ®è´¨é‡

#### **F101: visualize_distribution** â­â­â­â­â­
```
åç§°: å•æ–‡æ¡£ä¸»é¢˜æ¦‚ç‡åˆ†å¸ƒå¯è§†åŒ–
åŠŸèƒ½æè¿°: æ˜¾ç¤ºæŸæ¡æ–‡æ¡£å±äºå„ä¸»é¢˜çš„ç½®ä¿¡åº¦ç™¾åˆ†æ¯”
å®ç°éš¾åº¦: â­ ç®€å•
æ‰€éœ€å‚æ•°: 
  - probabilities: å•æ¡æ–‡æ¡£çš„ä¸»é¢˜æ¦‚ç‡æ•°ç»„
  - min_probability: æœ€å°æ˜¾ç¤ºæ¦‚ç‡é˜ˆå€¼(é»˜è®¤0.015)
ä½¿ç”¨åœºæ™¯:
  âœ“ ç†è§£æ¨¡å‹å¯¹å•æ¡æ„è§çš„åˆ¤æ–­ä¿¡å¿ƒ
  âœ“ è¯†åˆ«å¤šä¸»é¢˜æ–‡æ¡£(æ¦‚ç‡åˆ†æ•£)
  âœ“ è°ƒè¯•æ¨¡å‹ç½®ä¿¡åº¦
è¾“å‡ºæ ¼å¼: äº¤äº’å¼æŸ±çŠ¶å›¾(Plotly)
æ¨èä½ç½®: é¡µé¢9 Tab1 "å•æ–‡æ¡£åˆ†æ"
```

#### **F102: visualize_approximate_distribution (Tokençº§)** â­â­â­â­â­
```
åç§°: Tokençº§åˆ«ä¸»é¢˜åˆ†å¸ƒåˆ†æ
åŠŸèƒ½æè¿°: ç²¾ç¡®åˆ°å•è¯çº§åˆ«,æ˜¾ç¤ºå“ªäº›è¯è§¦å‘äº†å“ªä¸ªä¸»é¢˜
å®ç°éš¾åº¦: â­â­ ä¸­ç­‰
æ‰€éœ€å‚æ•°:
  - docs: åŸå§‹æ–‡æ¡£åˆ—è¡¨
  - calculate_tokens: True (åœ¨approximate_distributionä¸­è®¾ç½®)
ä½¿ç”¨åœºæ™¯:
  âœ“ å¯è§£é‡Šæ€§åˆ†æ - ä¸ºä»€ä¹ˆåˆ†åˆ°æŸä¸»é¢˜
  âœ“ è¯†åˆ«å…³é”®è§¦å‘è¯æ±‡
  âœ“ è´¨é‡æ£€æµ‹å’Œæ¨¡å‹æ”¹è¿›
è¾“å‡ºæ ¼å¼: é«˜äº®æ˜¾ç¤ºè¡¨æ ¼æˆ–å½©è‰²æ–‡æœ¬
æ¨èä½ç½®: é¡µé¢9 Tab2 "è¯çº§åˆ†æ"
```

#### **F103: reduce_outliers** â­â­â­â­
```
åç§°: ç¦»ç¾¤å€¼è‡ªåŠ¨é‡åˆ†ç±»
åŠŸèƒ½æè¿°: å°†noiseæ–‡æ¡£(æ ‡ç­¾-1)é‡æ–°åˆ†é…åˆ°æœ‰æ•ˆä¸»é¢˜
å®ç°éš¾åº¦: â­ ç®€å•(é€‰æ‹©åˆé€‚ç­–ç•¥)
æ”¯æŒçš„4ç§ç­–ç•¥:
  1. "probabilities" - åŸºäºHDBSCANè½¯èšç±»æ¦‚ç‡
  2. "distributions" - åŸºäºè¿‘ä¼¼ä¸»é¢˜åˆ†å¸ƒ
  3. "c-tf-idf" - åŸºäºè¯é¢‘ç›¸ä¼¼åº¦(æœ€å¿«)
  4. "embeddings" - åŸºäºè¯­ä¹‰embeddingç›¸ä¼¼åº¦(æœ€å‡†)
ä½¿ç”¨åœºæ™¯:
  âœ“ æé«˜æ•°æ®åˆ©ç”¨ç‡(å½“å‰noiseå æ¯”: è§æ•°æ®)
  âœ“ è·å¾—æ›´å®Œæ•´çš„ä¸»é¢˜è¦†ç›–
  âœ“ å‡å°‘"æœªåˆ†ç±»"æ–‡æ¡£
å‚æ•°è°ƒä¼˜:
  - threshold: 0.05-0.3 (åˆ†é…ç½®ä¿¡åº¦)
æ¨èä½ç½®: é¡µé¢9 Tab4 "ç¦»ç¾¤å€¼å¤„ç†"
è¾“å‡º: æ›´æ–°åçš„topicsæ•°ç»„ + ç»Ÿè®¡æŠ¥å‘Š
```

---

### ç¬¬äºŒæ¢¯é˜Ÿ (é‡è¦) - å¯ç”¨æ€§å¢å¼º

#### **F104: set_topic_labels** â­â­â­â­
```
åç§°: è‡ªå®šä¹‰ä¸»é¢˜æ ‡ç­¾è®¾ç½®
åŠŸèƒ½æè¿°: æ‰‹åŠ¨è®¾ç½®æ›´æ˜“è¯»çš„ä¸»é¢˜åç§°(æ›¿ä»£è‡ªåŠ¨ç”Ÿæˆåç§°)
å®ç°éš¾åº¦: â­ ç®€å•
æ”¯æŒä¸¤ç§æ–¹å¼:
  1. å…¨å±€è®¾ç½®: set_topic_labels(label_dict)
  2. å•ä¸ªè®¾ç½®: set_topic_labels({1: "Space Travel", 7: "Religion"})
ä½¿ç”¨åœºæ™¯:
  âœ“ æé«˜å¯è¯»æ€§
  âœ“ ä¾¿äºå›¢é˜Ÿæ²Ÿé€š
  âœ“ é€‚é…ä¸šåŠ¡æœ¯è¯­
ç¤ºä¾‹è¾“å…¥:
  {
    0: "ç¨æ”¶æ”¿ç­–èˆ†è®º",
    1: "è·¨å¢ƒç”µå•†è§„èŒƒ",
    2: "æ¶ˆè´¹è€…æƒç›Š",
  }
æ¨èä½ç½®: é¡µé¢9 Tab5 "æ ‡ç­¾ç¼–è¾‘å™¨"
```

#### **F105: visualize_barchart** â­â­â­â­
```
åç§°: å¤šä¸»é¢˜è¯æƒé‡å¯¹æ¯”
åŠŸèƒ½æè¿°: å¹¶åˆ—å±•ç¤ºå¤šä¸ªä¸»é¢˜çš„topå…³é”®è¯å’Œæƒé‡
å®ç°éš¾åº¦: â­ ç®€å•
å‚æ•°å¯è°ƒ:
  - top_n_topics: æ˜¾ç¤ºå‰Nä¸ªä¸»é¢˜(é»˜è®¤5)
  - n_words: æ¯ä¸ªä¸»é¢˜æ˜¾ç¤ºè¯æ•°(é»˜è®¤10)
ä½¿ç”¨åœºæ™¯:
  âœ“ å¿«é€Ÿå¯¹æ¯”ä¸»é¢˜å·®å¼‚
  âœ“ è¯†åˆ«ä¸»é¢˜ç›¸ä¼¼æ€§
  âœ“ è´¨é‡æ£€æŸ¥
è¾“å‡ºæ ¼å¼: åˆ†ç»„æŸ±çŠ¶å›¾(Plotly)
æ¨èä½ç½®: é¡µé¢8å‡çº§ç‰ˆ(æ›¿ä»£tab7)
```

#### **F106: search_topics** â­â­â­â­
```
åç§°: å…³é”®è¯ä¸»é¢˜æœç´¢
åŠŸèƒ½æè¿°: è¾“å…¥å…³é”®è¯æ‰¾æœ€ç›¸å…³çš„ä¸»é¢˜
å®ç°éš¾åº¦: â­ ç®€å•
ä½¿ç”¨åœºæ™¯:
  âœ“ å¿«é€Ÿå®šä½æ„Ÿå…´è¶£çš„ä¸»é¢˜
  âœ“ è¿½è¸ªç‰¹å®šè®®é¢˜(å¦‚"æ¶ˆè´¹ç¨")
  âœ“ èˆ†è®ºçƒ­ç‚¹ç›‘æµ‹
ç¤ºä¾‹æŸ¥è¯¢:
  - "ç”µå•†" -> è¿”å›ç›¸å…³ä¸»é¢˜åŠç›¸ä¼¼åº¦
  - "ç¨æ”¶" -> è¿”å›åŒ…å«ç¨æ”¶çš„ä¸»é¢˜
æ¨èä½ç½®: é¡µé¢9 Tab3 "å…³é”®è¯æœç´¢"
```

---

### ç¬¬ä¸‰æ¢¯é˜Ÿ (å¢å¼º) - è¾“å‡ºå’Œä¼˜åŒ–

#### **F107: visualize_document_datamap** â­â­â­
```
åç§°: å‘å¸ƒçº§é«˜è´¨é‡å¯è§†åŒ–
åŠŸèƒ½æè¿°: ç”Ÿæˆé™æ€çŸ¢é‡å›¾(PDF/PNG)é€‚åˆè®ºæ–‡/æŠ¥å‘Š
å®ç°éš¾åº¦: â­ ç®€å•
ä½¿ç”¨åœºæ™¯:
  âœ“ è¾“å‡ºåˆ°å­¦æœ¯è®ºæ–‡
  âœ“ ç”ŸæˆPPT/æŠ¥å‘Šå›¾è¡¨
  âœ“ é«˜åˆ†è¾¨ç‡è¾“å‡º
å‚æ•°:
  - interactive: False (é™æ€å›¾)
  - figsize: (12, 8)
è¾“å‡ºæ ¼å¼: PDF/SVG + Matplotlib Figure
æ¨èä½ç½®: é¡µé¢ä»»æ„å¤„ "å¯¼å‡ºä¸ºè®ºæ–‡å›¾"
```

#### **F108: update_topics** â­â­â­
```
åç§°: ä¸»é¢˜è¡¨ç¤ºæ›´æ–°
åŠŸèƒ½æè¿°: é‡æ–°è®¡ç®—ä¸»é¢˜è¯æ±‡(ä¼˜åŒ–n_gramã€å»åœç”¨è¯ç­‰)
å®ç°éš¾åº¦: â­ ç®€å•
ä½¿ç”¨åœºæ™¯:
  âœ“ æ”¹è¿›ä¸æ»¡æ„çš„ä¸»é¢˜è¡¨ç¤º
  âœ“ è°ƒæ•´n_gramèŒƒå›´(1-gram vs 2-gram)
  âœ“ æ·»åŠ è‡ªå®šä¹‰åœç”¨è¯
å‚æ•°å¯è°ƒ:
  - n_gram_range: (1, 2) or (1, 3)
  - stop_words: è‡ªå®šä¹‰åœç”¨è¯è¡¨
æ¨èä½ç½®: é¡µé¢9 Tab6 "ä¸»é¢˜ä¼˜åŒ–"
```

#### **F109: get_representative_docs** â­â­â­
```
åç§°: ä¸»é¢˜ä»£è¡¨æ–‡æ¡£æå–
åŠŸèƒ½æè¿°: è·å–æœ€èƒ½ä»£è¡¨è¯¥ä¸»é¢˜çš„æ–‡æ¡£åˆ—è¡¨
å®ç°éš¾åº¦: â­ ç®€å•
ä½¿ç”¨åœºæ™¯:
  âœ“ æ–‡æ¡£éªŒè¯(ç¡®è®¤ä¸»é¢˜æ­£ç¡®æ€§)
  âœ“ æ ·æœ¬æ”¶é›†(ç”¨äºè§„åˆ™å­¦ä¹ )
  âœ“ è´¨é‡è¯„ä¼°
è¾“å‡º: æ’åºçš„æ–‡æ¡£åˆ—è¡¨ + ç›¸ä¼¼åº¦åˆ†æ•°
æ¨èä½ç½®: é¡µé¢7 Tab6å‡çº§ç‰ˆ(å¢å¼ºæ–‡æ¡£æµè§ˆ)
```

---

### ç¬¬å››æ¢¯é˜Ÿ (é«˜çº§) - éœ€è¦æ—¶é—´æˆ³

#### **âŒ F110: visualize_topics_over_time**
```
åç§°: æ—¶é—´åºåˆ—ä¸»é¢˜æ¼”å˜
åŠŸèƒ½æè¿°: æ˜¾ç¤ºèˆ†è®ºè¯é¢˜å¦‚ä½•éšæ—¶é—´å˜åŒ–
å®ç°éš¾åº¦: â­â­â­ é«˜(éœ€è¦æ—¶é—´æˆ³)
å½“å‰çŠ¶æ€: âŒ ä¸é€‚ç”¨(æ•°æ®æ— timestampå­—æ®µ)
å¤‡æ³¨: è‹¥åç»­çˆ¬è™«æ·»åŠ timestamp,å¯å®ç°
```

---

## ğŸ“‹ å®ç°æ£€æŸ¥æ¸…å•

### ç«‹å³å¯å®ç°(ä¸éœ€ä¿®æ”¹ç°æœ‰æ•°æ®)

- [ ] **F101** visualize_distribution
  - [ ] åœ¨bertopic_analyzer.pyä¸­æ·»åŠ å‡½æ•°
  - [ ] åœ¨é¡µé¢9åˆ›å»ºæ–°Tab1
  - [ ] æ·»åŠ å•æ–‡æ¡£é€‰æ‹©å™¨
  - [ ] å±•ç¤ºæ¦‚ç‡åˆ†å¸ƒæŸ±çŠ¶å›¾
  
- [ ] **F102** visualize_approximate_distribution (Tokençº§)
  - [ ] è®¡ç®—approximate_distribution(calculate_tokens=True)
  - [ ] ç”Ÿæˆtoken-levelåˆ†å¸ƒ
  - [ ] åˆ›å»ºå¯è§†åŒ–ç»„ä»¶(é«˜äº®è¡¨æ ¼)
  
- [ ] **F103** reduce_outliers
  - [ ] æ·»åŠ 4ç§ç­–ç•¥é€‰é¡¹(å•é€‰æ¡†)
  - [ ] æ˜¾ç¤ºå½“å‰noiseæ¯”ä¾‹
  - [ ] å¯¹æ¯”å‰åç»Ÿè®¡
  - [ ] å¯é€‰ä¿å­˜æ›´æ–°çš„topics
  
- [ ] **F104** set_topic_labels
  - [ ] åˆ›å»ºæ ‡ç­¾ç¼–è¾‘è¡¨å•
  - [ ] å®æ—¶é¢„è§ˆæ ‡ç­¾å˜åŒ–
  - [ ] ä¿å­˜æ ‡ç­¾è®¾ç½®(åˆ°session state)
  
- [ ] **F105** visualize_barchart
  - [ ] æ›¿æ¢é¡µé¢8çš„Tab7
  - [ ] æ·»åŠ top_n_topicsæ»‘å—
  - [ ] å¯¹æ¯”æŸ±çŠ¶å›¾å±•ç¤º

- [ ] **F106** search_topics
  - [ ] æ–‡æœ¬è¾“å…¥æ¡†
  - [ ] æœç´¢å¹¶è¿”å›ç›¸å…³ä¸»é¢˜
  - [ ] æ˜¾ç¤ºç›¸ä¼¼åº¦æ’åºåˆ—è¡¨

- [ ] **F107** visualize_document_datamap
  - [ ] æ·»åŠ å¯¼å‡ºæŒ‰é’®
  - [ ] ç”ŸæˆPNG/PDF
  - [ ] ä¿å­˜åˆ°downloads

### éœ€è¦æ•°æ®å‡†å¤‡

- [ ] **F109** get_representative_docs
  - éœ€è¦ä¿å­˜modelçš„representative_docs_

### ä¸é€‚ç”¨

- [x] **F110** visualize_topics_over_time
  - âŒ åŸå› : æ•°æ®æ— timestampå­—æ®µ

---

## ğŸ¯ åˆ†é˜¶æ®µå®ç°è®¡åˆ’

### Phase 4 (æœ¬å‘¨) - å¯è§£é‡Šæ€§ 3ä¸ªåŠŸèƒ½
1. F101 visualize_distribution
2. F102 visualize_approximate_distribution  
3. F103 reduce_outliers
**äº¤ä»˜**: é¡µé¢9 "äº’åŠ¨åˆ†æå·¥å…·"

### Phase 5 (ä¸‹å‘¨) - æ˜“ç”¨æ€§ 3ä¸ªåŠŸèƒ½
4. F104 set_topic_labels
5. F105 visualize_barchart
6. F106 search_topics
**äº¤ä»˜**: é¡µé¢8/9å‡çº§ç‰ˆ

### Phase 6 (å¯é€‰) - è¾“å‡ºå’Œä¼˜åŒ– 3ä¸ªåŠŸèƒ½
7. F107 visualize_document_datamap
8. F108 update_topics
9. F109 get_representative_docs
**äº¤ä»˜**: å®Œæ•´åˆ†æå¥—ä»¶

---

## ğŸ“Š æ•°æ®ç‰¹æ€§å‚è€ƒ

```
æ€»è®°å½•æ•°: 2,297æ¡
è¦†ç›–ç‡: 99.3% (2313æ¡åŸå§‹)
å­—æ®µ:
  - source_text: æ„è§æ–‡æœ¬
  - sentiment: positive/neutral/negative
  - risk_level: critical/high/medium/low
  - topic: é¢„å®šä¹‰åˆ†ç±»
  - actor: å‚ä¸æ–¹
  - pattern: èˆ†è®ºæ¨¡å¼
  - index: 0-2296
ç¼ºå¤±:
  âŒ timestamp - æ— æ³•å®ç°F110
  âŒ embeddingsç¼“å­˜ - æ¯æ¬¡éƒ½é‡ç®—
  âŒ probabilities - éœ€é‡æ–°è®­ç»ƒ
```

---

## ğŸ”§ æŠ€æœ¯è¦ç‚¹

### éœ€è¦ä¿®æ”¹çš„é…ç½®

1. **é‡æ–°è®­ç»ƒBERTopic (å¯ç”¨æ¦‚ç‡)**
```python
model = BERTopic(
    language="chinese",
    calculate_probabilities=True,  # â† è¿™ä¸€è¡Œ
    verbose=False
)
topics, probs = model.fit_transform(texts)
```

2. **Tokençº§åˆ†å¸ƒéœ€è¦è®¡ç®—**
```python
topic_distr, topic_token_distr = model.approximate_distribution(
    docs, 
    calculate_tokens=True  # â† è¿™ä¸€è¡Œ
)
```

3. **æœç´¢åŠŸèƒ½**
```python
similar_topics = model.find_topics(
    query="ç”µå•†ç¨æ”¶",
    top_n=5
)
```

---

## ğŸ“ˆ é¢„æœŸæ”¶ç›Š

| åŠŸèƒ½ç»„ | ç”¨æˆ·æ”¶ç›Š | ä¸šåŠ¡ä»·å€¼ |
|--------|--------|--------|
| F101-F102 | ç†è§£AIå†³ç­– | å¯ä¿¡åº¦â†‘ |
| F103-F104 | æ•°æ®è´¨é‡â†‘ | åˆ†æå‡†åº¦â†‘ |
| F105-F106 | ä½¿ç”¨ä½“éªŒâ†‘ | æ•ˆç‡â†‘ |
| F107-F109 | è¾“å‡ºè§„èŒƒ | å¯è¾“å‡ºè®ºæ–‡ |

---

## ğŸ’¾ æ–‡ä»¶ç»“æ„

```
streamlit_app/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ bertopic_analyzer.py      (å·²æœ‰: F001-F008)
â”‚   â”‚                              (å¾…åŠ : F101-F109)
â”‚   â””â”€â”€ data_loader.py
â””â”€â”€ pages/
    â”œâ”€â”€ 7_è¯é¢˜çƒ­åº¦æ•æ„Ÿåº¦åˆ†æ.py     (å·²æœ‰: F001-F005)
    â”œâ”€â”€ 8_æ·±åº¦è¯é¢˜åˆ†æ.py          (å·²æœ‰: F006-F008)
    â””â”€â”€ 9_äº’åŠ¨åˆ†æå·¥å…·.py          (å¾…å»º: F101-F106)
```

---

## ğŸ“ å¿«é€Ÿå‚è€ƒ

**æƒ³å¿«é€Ÿçœ‹è¿›åº¦?**
```bash
cd ç”µå•†èˆ†è®ºæ•°æ®äº§å“
git log --oneline | head -20
```

**æƒ³é‡æ–°è®­ç»ƒæ¨¡å‹(å¯ç”¨æ¦‚ç‡)?**
ä¿®æ”¹ `bertopic_analyzer.py` ç¬¬30-34è¡Œï¼š
```python
model = BERTopic(
    embedding_model=embedding_model,
    language="chinese",
    calculate_probabilities=True,  # â† æ”¹è¿™é‡Œ
    verbose=False
)
```

**æƒ³çœ‹ç°æœ‰åŠŸèƒ½æ¼”ç¤º?**
è®¿é—®: http://localhost:8501 â†’ é¡µé¢7 or é¡µé¢8

---

**ç”Ÿæˆæ—¥æœŸ**: 2025-12-11  
**ä¸‹ä¸€æ­¥**: é€‰æ‹©Phase 4çš„3ä¸ªåŠŸèƒ½å¼€å§‹å®ç°
