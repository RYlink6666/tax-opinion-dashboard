"""
使用指南 - 完整的用户手册
"""

import streamlit as st

st.set_page_config(
    page_title="使用指南",
    page_icon="📖",
    layout="wide"
)

st.title("📖 跨境电商税收舆论分析平台 - 使用指南")

st.markdown("""
**项目**: 跨境电商税收政策舆论分析可视化系统  
**数据规模**: 2,297条舆论数据（新浪微博、知乎、小红书等跨平台）  
**分析维度**: 情感倾向、风险等级、话题分类、参与方身份、交易模式
""")

st.markdown("---")

# 快速导航
st.subheader("🎯 快速导航：我想...")

col1, col2 = st.columns(2)

with col1:
    st.markdown("""
    ### 快速开始
    
    | 你的目标 | 推荐页面 |
    |--------|--------|
    | **快速了解所有数据** | P1 总体概览 |
    | **找到特定意见** | P2 意见搜索 |
    | **识别风险舆论** | P3 风险分析 |
    | **理解交易模式差异** | P4 模式分析 |
    """)

with col2:
    st.markdown("""
    ### 深度分析
    
    | 你的目标 | 推荐页面 |
    |--------|--------|
    | **了解各类人群观点** | P5 参与方分析 |
    | **获取政策制定建议** | P6 政策建议 |
    | **找到敏感话题** | P7 话题热度敏感度分析 |
    | **深入分析单条舆论** | P9 互动分析工具 |
    """)

st.markdown("---")

# 页面详解
st.subheader("📊 各页面详解")

with st.expander("P1 - 总体概览 📈", expanded=False):
    st.markdown("""
    **核心目标**: 30秒内掌握舆论数据概况

    **展示内容**：
    - 📊 **关键指标卡片** (5张)：总舆论数、正面比例、风险舆论数、主流话题、核心参与方
    - 📈 **4个维度的分布**：情感分布、风险分布、话题分布、参与方分布

    **适用用户**: 决策者、新用户、高管

    **使用建议**：
    1. 打开P1，查看5张指标卡片（30秒）
    2. 滚动查看4个分布图（1分钟）
    3. 若发现异常指标，点击相应页面深入分析
    """)

with st.expander("P2 - 意见搜索 🔍", expanded=False):
    st.markdown("""
    **核心目标**: 用多条件过滤找到你需要的舆论

    **交互功能**：
    - 🔎 **关键词搜索**：在原文中搜索任意关键词
    - 📋 **多维度筛选**：情感、风险等级、话题、参与方
    - 📊 **结果展示**：表格形式，支持排序和分页

    **典型应用场景**：
    - 场景1：找所有"负面 + 高风险"的舆论
    - 场景2：查找与"企业成本"相关的所有舆论
    - 场景3：看消费者对"跨境电商税收"话题的意见
    """)

with st.expander("P3 - 风险分析 🚨", expanded=False):
    st.markdown("""
    **核心目标**: 发现最危险的舆论，了解风险分布

    **分析维度**：
    - 🔴 **风险等级分布** (饼图)
    - 🔥 **高风险舆论特征**：高风险舆论中的情感分布、话题关系、参与方关系
    - 📝 **高风险舆论示例**：展开器显示具体的高风险舆论原文

    **使用建议**（如果你是政策制定者）：
    1. 查看"严重"和"高"风险的舆论数量
    2. 看热力图，找出"高风险 + XX话题"的组合
    3. 点开示例，阅读几条最危险的舆论
    4. 制定针对性的政策应对措施
    """)

with st.expander("P4 - 模式分析 📊", expanded=False):
    st.markdown("""
    **核心目标**: 理解不同交易模式下的舆论差异

    **分析维度**：
    - 📈 **各模式的舆论数量** (柱状图)
    - 😊 **各模式的情感倾向** (堆积图)
    - ⚠️ **各模式的风险特征** (热力图)
    - 💬 **各模式的典型案例**

    **关键问题**：
    - 哪个模式舆论最积极？
    - 哪个模式风险最大？
    - 我应该鼓励哪个模式？
    """)

with st.expander("P5 - 参与方分析 👥", expanded=False):
    st.markdown("""
    **核心目标**: 理解消费者、企业、政府等不同群体的观点

    **分析维度**：
    - 📊 **参与方舆论数量** (柱状图)
    - 😊 **参与方情感倾向** (堆积图)
    - ⚠️ **参与方的风险特征** (热力图)
    - 💬 **参与方的代表观点**

    **使用建议**：
    1. 在P5找到感兴趣的参与方（如"消费者"）
    2. 看堆积图，查看其情感分布
    3. 看热力图，了解其风险特征
    4. 点开示例，读几条代表性舆论
    """)

with st.expander("P6 - 政策建议 💡", expanded=False):
    st.markdown("""
    **核心目标**: 将舆论分析转化为决策建议

    **包含内容**：
    - 📌 **关键发现**（基于舆论数据）
    - 💼 **利益相关方观点总结**
    - ✅ **政策建议**（3-5条）
    - 📊 **实施指标**

    **使用场景**：
    - 向领导汇报：直接用这页内容
    - 制定政策方案：参考建议和观点
    - 评估政策影响：用指标跟踪效果
    """)

with st.expander("P7 - 话题热度敏感度分析 🔥", expanded=False):
    st.markdown("""
    **核心目标**: 找出最热的话题、最敏感的话题、最有争议的话题

    **分析维度**：
    - 📊 **话题热度** (柱状图)：各话题的舆论数量
    - 🔴 **话题敏感度** (热力图)：高/严重风险舆论的占比
    - 😊 **话题情感分布** (堆积图)：正/中/负面舆论的比例

    **关键应用**：
    - 消费者在讨论什么？
    - 哪个话题最容易出现风险舆论？
    - 我应该重点关注哪个话题？
    - 某话题是否安全讨论？
    """)

with st.expander("P9 - 互动分析工具 🔬", expanded=False):
    st.markdown("""
    **核心目标**: 深入分析单条舆论，理解其背景和含义

    **功能**：
    - 🔍 **舆论选择**：按条件筛选或输入关键词搜索
    - 📊 **单条详情**：完整原文、来源、自动识别的特征
    - 🏷️ **标签管理**：自定义添加/编辑标签

    **典型应用**：
    - 快速判断一条舆论的特征
    - 深入研究某个舆论背景
    - 质量控制：验证自动分析是否准确
    """)

st.markdown("---")

# 分析路径
st.subheader("🔗 推荐分析路径")

tab1, tab2, tab3 = st.tabs(["风险管理路径", "决策支持路径", "话题深入路径"])

with tab1:
    st.markdown("""
    ```
    P1 (发现有20%高风险舆论)
      ↓
    P3 (分析风险分布，找出最危险的话题和参与方)
      ↓
    P5 (看哪个参与方制造最多高风险舆论)
      ↓
    P9 (查看具体的高风险舆论原文)
      ↓
    P6 (制定针对性的回应或政策措施)
    ```
    """)

with tab2:
    st.markdown("""
    ```
    P1 (了解整体舆论情况)
      ↓
    P4 (理解不同交易模式的舆论差异)
      ↓
    P5 (理解不同参与方的观点)
      ↓
    P6 (根据舆论提出政策建议)
    ```
    """)

with tab3:
    st.markdown("""
    ```
    P7 (找出最热/最敏感的话题)
      ↓
    P2 (搜索该话题相关的所有舆论)
      ↓
    P3 (该话题的风险分布如何)
      ↓
    P5 (不同参与方对该话题的态度)
      ↓
    P9 (查看具体的代表性舆论)
    ```
    """)

st.markdown("---")

# 常见问题
st.subheader("❓ 常见问题 FAQ")

with st.expander("Q: 各页面的数据是同步的吗？", expanded=False):
    st.write("是的。所有页面都使用同一份数据源，经过相同的清洗和标签流程。")

with st.expander("Q: 数据多久更新一次？", expanded=False):
    st.write("目前是静态数据（2,297条固定舆论）。未来计划每月自动爬取新数据并更新。")

with st.expander("Q: 可以导出数据或报告吗？", expanded=False):
    st.write("P2（意见搜索）的表格可以直接复制数据。P6（政策建议）的内容可以截图或复制用于报告。")

with st.expander("Q: 如果我发现数据或分析有误？", expanded=False):
    st.write("用P9反馈数据标签错误。在相关页面截图说明具体位置反馈其他问题。")

st.markdown("---")

# 快速上手
st.subheader("🚀 快速上手步骤")

col1, col2, col3 = st.columns(3)

with col1:
    st.markdown("""
    ### 第一次使用（5分钟）
    
    1. 打开首页，看3个关键指标
    2. 去P1，看完整的4个维度分布
    3. 去P2，搜索一个你关心的关键词
    4. 看搜索结果，理解表格结构
    5. 了解其他页面的大致功能
    """)

with col2:
    st.markdown("""
    ### 日常使用（10分钟）
    
    1. 打开P1或P7，快速了解今天的舆论热点
    2. 如有异常，去P3或P6深入分析
    3. 需要查找具体舆论时，去P2
    """)

with col3:
    st.markdown("""
    ### 深入分析（30-60分钟）
    
    1. 从P1开始，明确分析目标
    2. 根据目标选择相应页面流程
    3. 逐步深入，最后在P6汇总为建议
    """)

st.markdown("---")

st.success("""
💡 **核心建议**：
- 新用户：先看P1获得全局认知
- 快速查询：用P2搜索功能
- 深度分析：按分析路径逐步深入
- 决策支持：查看P6的政策建议
""")

st.markdown("""
---
**最后更新**: 2025-12-12  
**版本**: 1.0  
**适用产品**: 跨境电商税收舆论数据分析系统 v1.0
""")
